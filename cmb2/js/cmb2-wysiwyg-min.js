window.CMB2=window.CMB2||{},window.CMB2.wysiwyg=window.CMB2.wysiwyg||{},function(t,i,$,e,n){"use strict";function d(){0===c.length?s.forEach(function(t){s.splice(s.indexOf(t),1),e.init.apply(e,t)}):t.setTimeout(d,100)}function r(){c.forEach(function(t){c.splice(c.indexOf(t),1),e.destroy(t)})}function o(t){var i=t.groupid,e=t.fieldid;return f[i]&&f[i][e]||(f[i]=f[i]||{},f[i][e]={template:wp.template("cmb2-wysiwyg-"+i+"-"+e),defaults:{mce:$.extend({},tinyMCEPreInit.mceInit["cmb2_i_"+i+e]),qt:$.extend({},tinyMCEPreInit.qtInit["cmb2_i_"+i+e])}},delete tinyMCEPreInit.mceInit["cmb2_i_"+i+e],delete tinyMCEPreInit.qtInit["cmb2_i_"+i+e]),f[i][e]}function a(t){var i=new RegExp("cmb2_n_"+t.groupid+t.fieldid,"g"),e=new RegExp("cmb2_i_"+t.groupid+t.fieldid,"g"),n,d,r;if(void 0===tinyMCEPreInit.mceInit[t.id]){d=$.extend({},t.defaults.mce);for(n in d)"string"==typeof d[n]&&(d[n]=d[n].replace(e,t.id).replace(i,t.name));tinyMCEPreInit.mceInit[t.id]=d}if(void 0===tinyMCEPreInit.qtInit[t.id]){r=$.extend({},t.defaults.qt);for(n in r)"string"==typeof r[n]&&(r[n]=r[n].replace(e,t.id).replace(i,t.name));tinyMCEPreInit.qtInit[t.id]=r}}var c=[],s=[],f=e.all={};e.initAll=function(){var i,n,d;$(".cmb2-wysiwyg-placeholder").each(function(){i=$(this),n=i.data(),n.groupid&&(n.id=i.attr("id"),n.name=i.attr("name"),n.value=i.val(),e.init(i,n,!1),d=!0)}),!0===d&&t.QTags._buttonsInit()},e.addRow=function(t,i){e.initRow(i)},e.destroyRowEditors=function(t,i){e.destroy(i.parents(".cmb-repeatable-grouping").find(".wp-editor-area").attr("id"))},e.shiftStart=function(t,i,n,d){n.add(d).find(".wp-editor-wrap textarea").each(function(){e.destroy($(this).attr("id"))})},e.shiftComplete=function(t,i,n,d){n.add(d).each(function(){e.initRow($(this))})},e.initRow=function(i){var n,r;i.find(".cmb2-wysiwyg-inner-wrap").each(function(){n=$(this),r=n.data(),r.iterator=i.data("iterator"),r.fieldid=r.id,r.id=r.groupid+"_"+r.iterator+"_"+r.fieldid,r.name=r.groupid+"["+r.iterator+"]["+r.fieldid+"]",r.value=n.find(".wp-editor-area").length?n.find(".wp-editor-area").val():"",0===c.length?e.init(n,r):(s.push([n,r]),t.setTimeout(d,100))})},e.init=function(e,n,d){if(!n.groupid)return!1;$.extend(n,o(n)),a(n),e.replaceWith(n.template(n)),t.tinyMCE.init(tinyMCEPreInit.mceInit[n.id]),t.quicktags(tinyMCEPreInit.qtInit[n.id]),$(i.getElementById(n.id)).parents(".wp-editor-wrap").removeClass("html-active").addClass("tmce-active"),!1!==d&&t.QTags._buttonsInit()},e.destroy=function(i){var e=tinyMCE.get(i);null!==e&&void 0!==e?(e.destroy(),void 0===tinyMCEPreInit.mceInit[i]&&delete tinyMCEPreInit.mceInit[i],void 0===tinyMCEPreInit.qtInit[i]&&delete tinyMCEPreInit.qtInit[i]):-1===c.indexOf(i)&&(c.push(i),t.setTimeout(r,100))},$(i).on("cmb_init",e.initAll).on("cmb2_add_row",e.addRow).on("cmb2_remove_group_row_start",e.destroyRowEditors).on("cmb2_shift_rows_start",e.shiftStart).on("cmb2_shift_rows_complete",e.shiftComplete)}(window,document,jQuery,window.CMB2.wysiwyg);